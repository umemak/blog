<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>WSL on umemak</title><link>https://umemak.github.io/blog/tags/wsl/</link><description>Recent content in WSL on umemak</description><generator>Hugo</generator><language>ja-jp</language><copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright><lastBuildDate>Fri, 14 Oct 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://umemak.github.io/blog/tags/wsl/index.xml" rel="self" type="application/rss+xml"/><item><title>WSLのmakeでmkdir</title><link>https://umemak.github.io/blog/posts/2022/10/14_wsl_make/</link><pubDate>Fri, 14 Oct 2022 00:00:00 +0000</pubDate><guid>https://umemak.github.io/blog/posts/2022/10/14_wsl_make/</guid><description>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-Makefile" data-lang="Makefile">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">.PHONY&lt;/span>&lt;span style="color:#f92672">:&lt;/span> mkdir
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">mkdir&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	mkdir -p ./work/&lt;span style="color:#f92672">{&lt;/span>a,b,c&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ make mkdir 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mkdir -p ./work/&lt;span style="color:#f92672">{&lt;/span>a,b,c&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ ls work
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">{&lt;/span>a,b,c&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>なんでや。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ rm -r work
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>$ mkdir -p ./work/&lt;span style="color:#f92672">{&lt;/span>a,b,c&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>$ ls work
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>a b c
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>こうなってほしい。&lt;/p>
&lt;p>→make内では、デフォルトのシェルが&lt;code>/bin/sh&lt;/code>になっているので、Makefileで&lt;code>SHELL=/bin/bash&lt;/code>を書く必要がある。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://masahir0y.blogspot.com/2012/07/make_26.html">とあるエンジニアの備忘log: Make のポータビリティについて考える&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://qiita.com/nassy20/items/3183cc17f36a3f21e333">Makefileには使用するshellを定義すると良さそう - Qiita&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>WSL2その後</title><link>https://umemak.github.io/blog/posts/2022/10/06_wsl2/</link><pubDate>Thu, 06 Oct 2022 00:00:00 +0000</pubDate><guid>https://umemak.github.io/blog/posts/2022/10/06_wsl2/</guid><description>&lt;p>スリープ後にWSLが応答しなくなる現象はまだ起きていないけれど、すぐ本体が熱くなってファンが回るのは変わらず。&lt;/p>
&lt;p>頻繁にSSDの警告も出るし大丈夫なのかなこれ。。&lt;/p></description></item><item><title>WSL2の再インストール</title><link>https://umemak.github.io/blog/posts/2022/10/05_wsl2_install/</link><pubDate>Wed, 05 Oct 2022 00:00:00 +0000</pubDate><guid>https://umemak.github.io/blog/posts/2022/10/05_wsl2_install/</guid><description>&lt;p>Windows11 22H2が降ってきたので、インストールした。&lt;/p>
&lt;p>特に問題なさそうなので、WSL2を再インストールしようとしたところ&lt;/p>
&lt;pre tabindex="0">&lt;code>WSL 2 を実行するには、カーネル コンポーネントの更新が必要です。詳細については https://aka.ms/wsl2kernel を参照してください
&lt;/code>&lt;/pre>&lt;p>とのメッセージが。&lt;/p>
&lt;p>リンク先で「x64 マシン用 WSL2 Linux カーネル更新プログラム パッケージ」をダウンロードして、実行。&lt;/p></description></item><item><title>WSL2アンインストール</title><link>https://umemak.github.io/blog/posts/2022/10/03_wsl_uninstall/</link><pubDate>Mon, 03 Oct 2022 00:00:00 +0000</pubDate><guid>https://umemak.github.io/blog/posts/2022/10/03_wsl_uninstall/</guid><description>&lt;p>いいかげん改善しないので、WSLをアンインストールしてみた。&lt;/p>
&lt;p>WSLがないと使えないDocker Desktopもついでに消した。&lt;/p>
&lt;p>これでしばらく運用してみて、スリープ後の負荷上昇（地味に内部の温度上昇もやばい気がしている）が落ち着けば、またインストールしなおしてみようかと。&lt;/p>
&lt;p>Dockerがないとちょっとしたツールとか（openapi-generator）動かせないのが不便だけど、仕方ない。&lt;/p></description></item><item><title>Docker不調</title><link>https://umemak.github.io/blog/posts/2022/09/30_wsl/</link><pubDate>Fri, 30 Sep 2022 00:00:00 +0000</pubDate><guid>https://umemak.github.io/blog/posts/2022/09/30_wsl/</guid><description>&lt;p>WSL2の不調の影響か、Docker Desktopも応答がなくなることが多い。&lt;/p>
&lt;p>せっかくのノートPCなのに、毎回シャットダウンする運用はしたくないなぁ。&lt;/p>
&lt;p>Windows11の新しいの入れたら改善したりするのかしら。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://pc.watch.impress.co.jp/docs/topic/feature/1441763.html">【特集】ついに出た！Windows 11「22H2」の変更点まとめ。どこが変わって何が新しくなったのか？ - PC Watch&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>WSL2の再起動</title><link>https://umemak.github.io/blog/posts/2022/09/24_wsl_reboot/</link><pubDate>Sat, 24 Sep 2022 00:00:00 +0000</pubDate><guid>https://umemak.github.io/blog/posts/2022/09/24_wsl_reboot/</guid><description>&lt;p>最近、Inspiron13がスリープから復帰した後、高確率でWSL2が応答しなくなっている。&lt;/p>
&lt;p>PC再起動すれば直るのだけど、面倒。&lt;/p>
&lt;p>WSLだけ再起動でも直ることがわかった。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>wsl --shutdown
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ヘルプでは&lt;code>直ちに、すべての実行中の配布および WSL 2 軽快なユーティリティの仮想マシンを終了します。&lt;/code>と書かれているが（軽快なとは・・・？）、再起動してくる。&lt;/p></description></item><item><title>WSL2にbrewをつかってnodejsのインストールをする</title><link>https://umemak.github.io/blog/posts/2020/07/20_wsl_brew/</link><pubDate>Mon, 20 Jul 2020 00:00:00 +0000</pubDate><guid>https://umemak.github.io/blog/posts/2020/07/20_wsl_brew/</guid><description>&lt;p>Node.jsのバージョン管理したくなったので。&lt;/p>
&lt;h2 id="homebrewのインストール">Homebrewのインストール&lt;/h2>
&lt;p>&lt;a href="https://brew.sh/index_ja">https://brew.sh/index_ja&lt;/a> にしたがって。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ /bin/bash -c &amp;#34;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)&amp;#34;
$ sudo apt-get install build-essential
$ echo &amp;#39;eval $(/home/linuxbrew/.linuxbrew/bin/brew shellenv)&amp;#39; &amp;gt;&amp;gt; /home/`whoami`/.profile
$ eval $(/home/linuxbrew/.linuxbrew/bin/brew shellenv)
$ brew --version
Homebrew 2.4.8
Homebrew/linuxbrew-core (git revision 09353; last commit 2020-07-19)
&lt;/code>&lt;/pre>&lt;h2 id="インストール済みnodejsパッケージの削除">インストール済みnodejsパッケージの削除&lt;/h2>
&lt;p>aptで入れていたnodejsを削除。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ sudo apt remove nodejs
&lt;/code>&lt;/pre>&lt;h2 id="nodebrewのインストール">nodebrewのインストール&lt;/h2>
&lt;pre tabindex="0">&lt;code>$ brew install nodebrew
&lt;/code>&lt;/pre>&lt;h2 id="nodejsのインストール">nodejsのインストール&lt;/h2>
&lt;pre tabindex="0">&lt;code>$ nodebrew install v12.18.2
Fetching: https://nodejs.org/dist/v12.18.2/node-v12.18.2-linux-x64.tar.gz
Warning: Failed to create the file
Warning: /home/umemak/.nodebrew/src/v12.18.2/node-v12.18.2-linux-x64.tar.gz:
Warning: No such file or directory
curl: (23) Failed writing body (0 != 978)

download failed: https://nodejs.org/dist/v12.18.2/node-v12.18.2-linux-x64.tar.gz
&lt;/code>&lt;/pre>&lt;p>ディレクトリ掘ってみる&lt;/p>
&lt;pre tabindex="0">&lt;code>$ mkdir -p ~/.nodebrew/src
$ nodebrew install v12.18.2
Fetching: https://nodejs.org/dist/v12.18.2/node-v12.18.2-linux-x64.tar.gz
################################################################################################################# 100.0%
Installed successfully
&lt;/code>&lt;/pre>&lt;p>使用バージョン指定&lt;/p></description></item><item><title>WSLの時計を合わせる</title><link>https://umemak.github.io/blog/posts/2020/07/20_wsl_date/</link><pubDate>Mon, 20 Jul 2020 00:00:00 +0000</pubDate><guid>https://umemak.github.io/blog/posts/2020/07/20_wsl_date/</guid><description>&lt;p>&lt;code>apt update&lt;/code>したときにエラーになった場合の解決策のひとつ。
WSL側の時計が大幅にずれているパターン。&lt;/p>
&lt;p>&lt;a href="https://github.com/microsoft/WSL/issues/4245">https://github.com/microsoft/WSL/issues/4245&lt;/a> を参考に。&lt;/p>
&lt;pre tabindex="0">&lt;code># hwclock -s
&lt;/code>&lt;/pre></description></item><item><title>WSL2でAWS CLIを使ってS3のフォルダ名を変更する</title><link>https://umemak.github.io/blog/posts/2020/07/08_awscli_wsl2/</link><pubDate>Wed, 08 Jul 2020 00:00:00 +0000</pubDate><guid>https://umemak.github.io/blog/posts/2020/07/08_awscli_wsl2/</guid><description>&lt;p>S3って、マネジメントコンソールからフォルダ名の変更ってできないんですね。。&lt;/p>
&lt;p>&lt;a href="https://blog.goo.ne.jp/nakano-tomofumi/e/78ed6b49344715a89a9fdebeba8a8dd2">こちら&lt;/a>を参考に。&lt;/p>
&lt;p>SurfaceにしてからAWS CLIインストールしてなかったし、せっかくなのでWLS2のUbuntuでやってみます。&lt;/p>
&lt;p>公式の&lt;a href="https://docs.aws.amazon.com/ja_jp/cli/latest/userguide/install-cliv2-docker.html">Docker版&lt;/a>でインストール（というほどのことでもないですが）。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ docker run --rm -it amazon/aws-cli --version
aws-cli/2.0.29 Python/3.7.3 Linux/4.19.104-microsoft-standard botocore/2.0.0dev33
&lt;/code>&lt;/pre>&lt;p>認証情報入れる。
IAMでアクセスキーを取得して、configureコマンドで設定。&lt;/p>
&lt;pre tabindex="0">&lt;code>$ docker run --rm -ti -v ~/.aws:/root/.aws amazon/aws-cli configure
&lt;/code>&lt;/pre>&lt;p>動作確認&lt;/p></description></item></channel></rss>